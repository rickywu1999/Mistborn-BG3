// Level 3
new entry "Class_Feature_Combat_Enhancement"
type "PassiveData"
data "DisplayName" "hb08d2ef82a0c4d3fa3c9b91b401809d80efd"
data "Description" "h705e2032e17b4c049a69a9baa19087e23078"
data "Icon" "Passive_EnhancementAllomancer_CombatEnhancement"
data "Properties" "Highlighted"
data "Boosts" "UnlockInterrupt(Interrupt_Chromium_Base);UnlockInterrupt(Interrupt_Chromium_Enhance);UnlockInterrupt(Interrupt_Chromium_Flare);UnlockInterrupt(Interrupt_Nicrosil_Enhance);UnlockInterrupt(Interrupt_Nicrosil_Flare)"

new entry "Interrupt_Chromium_Base"
type "InterruptData"
data "DisplayName" "h497cf67e6fa8438192a556dae5ff88a8e2ea;1"
data "Description" "hfc27206d1eda4f71b84d122c71727945e311;3"
data "DescriptionParams" "1"
data "Icon" "Spell_Enhancement_Chromium_Leach"
data "InterruptContext" "OnCastHit"
data "InterruptContextScope" "Self"
data "Container" "YesNoDecision"
data "Conditions" "not HasStatus('CHROMIUM_DRAINED',context.Source) and Self(context.Source,context.Observer) and not (IsCriticalMiss() or IsMiss()) and IsMeleeWeaponAttack() and IsProficientWithEquippedWeapon() and not AnyEntityIsItem() and MistbornHasSpellSlots()"
data "Properties" "ApplyStatus(CHROMIUMDRAIN_1,100,-1);IF(HasPassive('Chromium_Savant',context.Source) and not SavingThrow(Ability.Wisdom,SourceSpellDC())):ApplyStatus(SPELL_BLOCK_CHROMIUM_SAVANT,100,1)"
data "Cost" "MetalReserves:1"
data "InterruptDefaultValue" "Ask;Enabled"
data "EnableCondition" "not HasStatus('SG_Polymorph') or Tagged('MINDFLAYER') or HasStatus('SG_Disguise')"
data "EnableContext" "OnStatusApplied;OnStatusRemoved"

new entry "Interrupt_Chromium_Enhance"
type "InterruptData"
using "Interrupt_Chromium_Base"
data "Icon" "Spell_Enhancement_Chromium_Leach_Enhance"
data "DisplayName" "h497cf67e6fa8438192a556dae5ff88a8e2ea;1"
data "DescriptionParams" "3"
data "Properties" "ApplyStatus(CHROMIUMDRAIN_3,100,-1);IF(HasPassive('Chromium_Savant',context.Source) and not SavingThrow(Ability.Wisdom,SourceSpellDC())):ApplyStatus(SPELL_BLOCK_CHROMIUM_SAVANT,100,1)"
data "Cost" "MetalReserves:2"

new entry "Interrupt_Chromium_Flare"
type "InterruptData"
using "Interrupt_Chromium_Base"
data "Icon" "Spell_Enhancement_Chromium_Leach_Flare"
data "DisplayName" "habb99eecd247469d98aee8a937b3dc15728f;1"
data "DescriptionParams" "6"
data "Conditions" "not HasPassive('Metal_Flaring',context.Source) and not HasStatus('CHROMIUM_DRAINED',context.Source) and Self(context.Source,context.Observer) and not (IsCriticalMiss() or IsMiss()) and IsMeleeWeaponAttack() and IsProficientWithEquippedWeapon() and not AnyEntityIsItem() and MistbornHasSpellSlots()"
data "Properties" "ApplyStatus(CHROMIUMDRAIN_6,100,-1);IF(HasPassive('Chromium_Savant',context.Source) and not SavingThrow(Ability.Wisdom,SourceSpellDC())):ApplyStatus(SPELL_BLOCK_CHROMIUM_SAVANT,100,1)"
data "Cost" "MetalReserves:4"

new entry "Interrupt_Nicrosil_Enhance"
type "InterruptData"
data "Icon" "Spell_Enhancement_Nicrosil_Infuse_Enhance"
data "DisplayName" "h45355baa980549a3a43fad73273f2c88a7b3;1"
data "Description" "hee01acb3a588464dae15a9b7205d9a7d8fe0;3"
data "ExtraDescription" "h40e706c0ab644d65b46b12200c6665289882"
data "InterruptContext" "OnCastHit"
data "InterruptContextScope" "Self"
data "Container" "YesNoDecision"
data "Conditions" "Self(context.Source,context.Observer) and not (IsCriticalMiss() or IsMiss()) and IsMeleeWeaponAttack() and IsProficientWithEquippedWeapon() and not AnyEntityIsItem() and MistbornRecentlyCastedSpell()"
data "Properties" "ApplyStatus(NICROSIL_APPLY,100,1)"
data "TooltipStatusApply" "ApplyStatus(NICROSIL_APPLY,100,1)"
data "Cost" "MetalReserves:2"
data "InterruptDefaultValue" "Ask;Enabled"
data "EnableCondition" "not HasStatus('SG_Polymorph') or Tagged('MINDFLAYER') or HasStatus('SG_Disguise')"
data "EnableContext" "OnStatusApplied;OnStatusRemoved"

new entry "Interrupt_Nicrosil_Flare"
type "InterruptData"
using "Interrupt_Nicrosil_Enhance"
data "Icon" "Spell_Enhancement_Nicrosil_Infuse_Flare"
data "DisplayName" "h97b35d2441b94062a4bb85d57c08c34c5ge4;1"
data "ExtraDescription" "hb554193c05674b0aa0a225901e2ba77a9b03"
data "Properties" "ApplyStatus(NICROSIL_APPLY_FLARE,100,1)"
data "Cost" "MetalReserves:4"





// Level 6
new entry "Class_Feature_Aluminum_Specialist"
type "PassiveData"
data "DisplayName" "hb8b01831ba4d43ea97223a38c35e183cd8f8"
data "Description" "he044376b503e4e6e9f9ea91d85bea9625f64"
data "Icon" "Passive_Enhancement_Aluminum"
data "Properties" "Highlighted"
data "Boosts" "UnlockSpell(Aluminum_Specialist_Container)"

new entry "Aluminum_Specialist_Container"
type "SpellData"
data "SpellType" "Target"
data "TargetRadius" "1.5"
data "TargetConditions" "Ally() or Self()"
data "DisplayName" "hb8b01831ba4d43ea97223a38c35e183cd8f8"
data "Description" "he044376b503e4e6e9f9ea91d85bea9625f64"
data "Icon" "Passive_Enhancement_Aluminum"
data "ContainerSpells" "Aluminum_Armor;Aluminum_Helm;Aluminum_Weapon"
data "CastTextEvent" "Cast"
data "SpellAnimation" "03114753-8d91-4c52-8207-728a67cdd59b,,;,,;bc6778cf-e501-4c69-a72f-bce826a4d2bd,,;b4d106fa-9605-48c8-9f73-2bef4fa9e07d,,;8fcb1f19-a84b-486d-81fa-098aaf7cc9be,,;,,;c5bd6ce6-281c-4314-9f74-9f7bb2f4cf03,,;,,;,,"
data "VerbalIntent" "Buff"
data "SpellFlags" "HasSomaticComponent;IsLinkedSpellContainer"
data "HitAnimationType" "MagicalNonDamage"
data "PrepareEffect" "7121a488-d9f8-4ef3-b398-568510966ebf"
data "CastEffect" "de404880-3c51-42ed-9938-51054ef009be"
data "TargetEffect" "dc81981e-3e4a-40f0-92eb-dd41b0d1da59"
data "SpellFlags" "HasSomaticComponent;IsLinkedSpellContainer"
data "RequirementConditions" "not HasStatus('ALUMINUM_SPECIALIST')"
data "Cooldown" "OncePerRest"

new entry "Aluminum_Armor"
type "SpellData"
data "SpellType" "Target"
using "Aluminum_Specialist_Container"
data "SpellContainerID" "Aluminum_Specialist_Container"
data "Icon" "Passive_EnhancementAllomancer_AluminumArmor"
data "DisplayName" "h03f25b54a68545e08f153b6da0dd1b0bg0dc;2"
data "Description" "h656f992f72174ea397f7344cdc5f83c0110c;8"
data "ExtraDescription" "hab762bde53fc48eeae6b9bd2274234cbcdab;2"
data "ExtraDescriptionParams" "10"
data "SpellProperties" "ApplyStatus(ALUMINUM_ARMOUR,100,-1);ApplyStatus(SELF,ALUMINUM_SPECIALIST,100,-1)"

new entry "ALUMINUM_ARMOUR"
type "StatusData"
data "StatusType" "BOOST"
data "DisplayName" "h03f25b54a68545e08f153b6da0dd1b0bg0dc;2"
data "Description" "h157bf07583ed43de823ca62777eff35318g1;8"
data "Icon" "Passive_EnhancementAllomancer_AluminumArmor"
data "Boosts" "UnlockInterrupt(Interrupt_Aluminum_Counterspell)"
data "StatusPropertyFlags" "ApplyToDead"
data "StackType" "Ignore"

new entry "Aluminum_Equipment"
type "SpellData"
data "SpellType" "Target"
using "Target_Counterspell"
data "Icon" "Spell_Enhancement_Aluminum_Counterspell"
data "DisplayName" "h03f25b54a68545e08f153b6da0dd1b0bg0dc;2"
data "Description" "h656f992f72174ea397f7344cdc5f83c0110c;8"
data "Level" ""
data "SpellSchool" ""
data "ExtraDescription" "hab762bde53fc48eeae6b9bd2274234cbcdab;2"
data "ExtraDescriptionParams" "10"
data "UseCosts" "ReactionActionPoint:1"
data "RootSpellID" ""
data "InterruptPrototype" "Interrupt_Aluminum_Counterspell"
data "SpellFlags" ""

new entry "Interrupt_Aluminum_Counterspell"
type "InterruptData"
using "Interrupt_Counterspell"
data "Icon" "Spell_Enhancement_Aluminum_Counterspell"
data "DisplayName" "h03f25b54a68545e08f153b6da0dd1b0bg0dc;2"
data "Description" "hf91255b95b294dabad63f37c0fe76a237dcd;8"
data "DescriptionParams" "your proficiency bonus"
data "Roll" "MistbornCounterspell(context.Observer.ProficiencyBonus)"
data "Success" "Counterspell();UseSpell(OBSERVER_SOURCE,Target_Aluminum_CounterSpell_Success,true,true,true)"
data "Failure" "UseSpell(OBSERVER_SOURCE,Target_Aluminum_CounterSpell_Failure,true,true,true)"
data "Properties" "RemoveStatus(OBSERVER_OBSERVER,ALUMINUM_ARMOUR)"
data "Conditions" "not HasSpellCastBlocked(context.Observer) and IsAbleToReact(context.Observer) and Enemy(context.Source,context.Observer) and not Self(context.Source, context.Observer) and Self(context.Target,context.Observer) and IsSpell() and not Uninterruptible() and not HasStringInSpellRoll('WeaponAttack') and not AnyEntityIsItem() and not SpellId('Shout_END_Gale_ActivateNethereseOrb') and CounterspellCheck(context.Observer, context.Source)"
data "Cost" "ReactionActionPoint:1"

new entry "Target_Aluminum_CounterSpell_Success"
type "SpellData"
data "SpellType" "Target"
using "Aluminum_Equipment"
data "PrepareSound" "Spell_Prepare_Damage_Radiant_Gen_L1to3"
data "PrepareLoopSound" "Spell_Prepare_Damage_Radiant_Gen_L1to3_Loop"
data "CastSound" "Spell_Cast_Buff_BladeWard_L1to3"
data "TargetSound" "Spell_Impact_Buff_BladeWard_L1to3"
data "CastTextEvent" "Cast"
data "SpellAnimation" "03496c4a-49e0-4132-b585-3e5ecd1ad8e5,,;,,;4156d364-d2c0-4a01-908c-3552f78f434d,,;6f0a29b6-0ae8-4ebf-a1e4-8069c4a6ad16,,;a9682ef9-5d9e-4ac0-8144-2c7fe6eb868c,,;,,;32fb4d91-7fde-4b05-9144-ea87b9a4284a,,;,,;,,"
data "CastEffect" "b2cd6abf-78c7-4197-9e01-8b68a899bcdd"
data "TargetEffect" ""
data "BeamEffect" ""
data "InterruptPrototype" ""

new entry "Target_Aluminum_CounterSpell_Failure"
type "SpellData"
data "SpellType" "Target"
using "Target_Aluminum_CounterSpell_Success"
data "TargetRadius" "18"
data "DisplayName" "h54fa64b7g22ebg48abg86f5ga33a483739d2;3"
data "CastSound" ""
data "CastTextEvent" "Cast"
data "SpellAnimation" ",,;,,;10f0aecc-d23f-4922-b2ca-04a1d304054d,,;,,;,,;,,;,,;,,;,,"
data "TargetEffect" ""
data "BeamEffect" ""

new entry "Aluminum_Helm"
type "SpellData"
data "SpellType" "Target"
using "Aluminum_Specialist_Container"
data "SpellContainerID" "Aluminum_Specialist_Container"
data "Icon" "Passive_EnhancementAllomancer_AluminumHelm"
data "DisplayName" "h154c06ba35844d1ca44ae05f804168d9gd95;2"
data "Description" "hf624dcbd2a8a45cdaa42a1860e349ca1e29a;8"
data "SpellProperties" "ApplyStatus(ALUMINUM_HELM,100,-1);ApplyStatus(SELF,ALUMINUM_SPECIALIST,100,-1)"
data "TooltipStatusApply" "ApplyStatus(ALUMINUM_HELM,100,-1)"

new entry "ALUMINUM_HELM"
type "StatusData"
data "StatusType" "BOOST"
data "DisplayName" "h154c06ba35844d1ca44ae05f804168d9gd95;2"
data "Description" "h95ea2d6e493e41f0a4159678585e57d1bf05;8"
data "Icon" "Passive_EnhancementAllomancer_AluminumHelm"
data "Boosts" "Tag(CHARMED_ADV);Tag(FRIGHTENED_ADV)"
data "StatusPropertyFlags" "ApplyToDead"
data "StackType" "Ignore"

new entry "Aluminum_Weapon"
type "SpellData"
data "SpellType" "Target"
using "Aluminum_Specialist_Container"
data "SpellContainerID" "Aluminum_Specialist_Container"
data "Icon" "Passive_EnhancementAllomancer_AluminumWeapon"
data "DisplayName" "h247826c862e6481bacc025c6e7b0df8533ae;2"
data "Description" "h2a2b2f0872cb47f9b10467a1a93ccefdeeea;2"
data "SpellProperties" "ApplyStatus(ALUMINUM_WEAPON,100,-1);ApplyStatus(SELF,ALUMINUM_SPECIALIST,100,-1)"
data "TooltipStatusApply" "ApplyStatus(ALUMINUM_WEAPON,100,-1)"

new entry "ALUMINUM_WEAPON"
type "StatusData"
data "StatusType" "BOOST"
data "DisplayName" "h247826c862e6481bacc025c6e7b0df8533ae;2"
data "Description" "h735e267a86cd45069355e156b327c84b72b1;2"
data "Icon" "Passive_EnhancementAllomancer_AluminumWeapon"
data "Boosts" "CannotBeDisarmed();StatusImmunity(DISARM);RollBonus(Attack,1)"
data "StatusPropertyFlags" "ApplyToDead"
data "StackType" "Ignore"

new entry "ALUMINUM_SPECIALIST"
type "StatusData"
data "StatusType" "BOOST"
data "StatusPropertyFlags" "DisableOverhead;DisableCombatlog;DisablePortraitIndicator;ApplyToDead"
data "StackType" "Ignore"






// Level 11
new entry "Class_Feature_Extended_Effect"
type "PassiveData"
data "DisplayName" "ha6b2b7b051584cc09641382c23fd6d9a2b31"
data "Description" "h7ff18c91b3474133b3d363807dbc3446985g"
data "DescriptionParams" "Distance(5)"
data "Icon" "Passive_EnhancementAllomancer_ExtendedEffect"
data "Properties" "Highlighted"
data "Boosts" "UnlockSpellVariant(MistbornExtendedEffectAbilities(),ModifyTargetRadius(Override,5))"
data "StatsFunctorContext" "OnCast"
data "Conditions" "MistbornExtendedEffectAbilities()"
data "StatsFunctors" "ApplyStatus(SELF,EXTRA_ATTACK_Q,100,1);"






// Level 17
new entry "Class_Feature_Controlled_Burst"
type "PassiveData"
data "DisplayName" "h1e7d85d8769b467cb3c962f32d4fbabc3g1b"
data "Description" "hd1b952d2d11b47d5893e33d580ce70432084"
data "Icon" "Passive_EnhancementAllomancer_ControlledBurst"
data "Properties" "Highlighted"
data "Boosts" "UnlockSpellVariant(MistbornDuraluminAbilities(),ModifyUseCosts(Replace,BonusActionPoint,0,0,BonusActionPoint),ModifyUseCosts(Replace,MetalReserves,6,0,MetalReserves),ModifyTooltipDescription());UnlockSpellVariant(SpellId('Nicrosil_Boost_Enhance'),ModifyUseCosts(Replace,MetalReserves,4,0,MetalReserves),ModifyTooltipDescription());UnlockSpellVariant(SpellId('Nicrosil_Boost_Flare'),ModifyUseCosts(Replace,MetalReserves,6,0,MetalReserves),ModifyTooltipDescription())"